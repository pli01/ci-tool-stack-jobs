- project:
   name: jobs-deployer
   jobs:
     - 'updater-{name}-{jobname}'
   jobname:
# place here all job dir to populate
     - job-hello-world-1
     - job-hello-world-2

- defaults:
    name: global
    description: |
      <p><b>Do not edit this job through the web</b></p>
    project-type: freestyle
    concurrent: false
    block-downstream: true
    block-upstream: true
    logrotate:
      daysToKeep: 1
      numToKeep: 2
      artifactDaysToKeep: -1
      artifactNumToKeep: -1
    wrappers:
      - timestamps
      - ansicolor
      - workspace-cleanup
      - mask-passwords

- job-template:
    name: 'updater-{name}-{jobname}'
    parameters:
    scm:
      - repo-jobs-deployer
    triggers:
      - pollscm:
          cron: "H/5 * * * *"
    builders:
      - ci-jobs-deployer-make:
          JJB_JOBS: "{jobname}"

- scm:
    name: repo-jobs-deployer
    scm:
      - git:
         url: http://github.com/pli01/ci-tool-stack-jobs.git
#         credentials-id: jenkins-builder-id
         basedir: jobs-deployer
         branches:
          - origin/master
         wipe-workspace: true
         skip-tag: true

- builder:
    name: ci-jobs-deployer-make
    builders:
      - shell: '( cd jobs-deployer && make JJB_JOBS={JJB_JOBS} JJB_USER=admin )'
